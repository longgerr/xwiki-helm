should generate additional environment variables:
  1: |
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          key: DB_PASSWORD
          name: RELEASE-NAME-xwiki
    - name: INDEX_HOST
      valueFrom:
        configMapKeyRef:
          key: INDEX_HOST
          name: RELEASE-NAME-xwiki
    - name: INDEX_PORT
      valueFrom:
        configMapKeyRef:
          key: INDEX_PORT
          name: RELEASE-NAME-xwiki
    - name: DB_HOST
      valueFrom:
        configMapKeyRef:
          key: DB_HOST
          name: RELEASE-NAME-xwiki
    - name: DB_USER
      valueFrom:
        configMapKeyRef:
          key: DB_USER
          name: RELEASE-NAME-xwiki
    - name: DB_DATABASE
      valueFrom:
        configMapKeyRef:
          key: DB_DATABASE
          name: RELEASE-NAME-xwiki
    - name: SOME_ENV
      value: some-value
should generate initContainer to patch config files:
  1: |
    - command:
      - /bin/bash
      - -c
      - |-
        update-config.sh -c "xwiki.cfg" -a "xwiki.authentication.authclass" -v "org.xwiki.contrib.authentication.customfield.CustomFieldAuthenticator" -r "/usr/local/xwiki/data"
        update-config.sh -c "xwiki.cfg" -a "xwiki.superadminpassword" -v "the-pass-word" -r "/usr/local/xwiki/data"
      image: langyb/xwiki-toolbox:latest
      imagePullPolicy: Always
      name: update-config
      volumeMounts:
      - mountPath: /usr/local/xwiki/data
        name: xwiki-data
should properly set value:
  1: |
    - mountPath: /usr/local/xwiki/data
      name: xwiki-data
  2: |
    - name: xwiki-data
      persistentVolumeClaim:
        claimName: RELEASE-NAME-xwiki
should properly set value pvc:
  1: |
    accessModes:
    - ReadWriteMany
    resources:
      requests:
        storage: 200Gi
should run in node sticky mode and use hostPath storage:
  1: |
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: xwiki
            operator: In
            values:
            - "true"
should set environment variables from external DB configMap and secret:
  1: |
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          key: DB_PASSWORD_FROM_SECRET
          name: xwiki-db-secret
    - name: INDEX_HOST
      valueFrom:
        configMapKeyRef:
          key: INDEX_HOST
          name: RELEASE-NAME-xwiki
    - name: INDEX_PORT
      valueFrom:
        configMapKeyRef:
          key: INDEX_PORT
          name: RELEASE-NAME-xwiki
    - name: DB_HOST
      valueFrom:
        configMapKeyRef:
          key: DB_HOST_FROM_CONFIGMAP
          name: xwiki-db-config-map
    - name: DB_USER
      valueFrom:
        configMapKeyRef:
          key: DB_USER_FROM_CONFIGMAP
          name: xwiki-db-config-map
    - name: DB_DATABASE
      valueFrom:
        configMapKeyRef:
          key: DB_NAME_FROM_CONFIGMAP
          name: xwiki-db-config-map
should use custom image:
  1: |
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          key: DB_PASSWORD
          name: RELEASE-NAME-xwiki
    - name: INDEX_HOST
      valueFrom:
        configMapKeyRef:
          key: INDEX_HOST
          name: RELEASE-NAME-xwiki
    - name: INDEX_PORT
      valueFrom:
        configMapKeyRef:
          key: INDEX_PORT
          name: RELEASE-NAME-xwiki
    - name: DB_HOST
      valueFrom:
        configMapKeyRef:
          key: DB_HOST
          name: RELEASE-NAME-xwiki
    - name: DB_USER
      valueFrom:
        configMapKeyRef:
          key: DB_USER
          name: RELEASE-NAME-xwiki
    - name: DB_DATABASE
      valueFrom:
        configMapKeyRef:
          key: DB_DATABASE
          name: RELEASE-NAME-xwiki
should use mysql lts image:
  1: |
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          key: mysql-password
          name: RELEASE-NAME-mysql
    - name: INDEX_HOST
      valueFrom:
        configMapKeyRef:
          key: INDEX_HOST
          name: RELEASE-NAME-xwiki
    - name: INDEX_PORT
      valueFrom:
        configMapKeyRef:
          key: INDEX_PORT
          name: RELEASE-NAME-xwiki
    - name: DB_HOST
      valueFrom:
        configMapKeyRef:
          key: DB_HOST
          name: RELEASE-NAME-xwiki
    - name: DB_USER
      valueFrom:
        configMapKeyRef:
          key: DB_USER
          name: RELEASE-NAME-xwiki
    - name: DB_DATABASE
      valueFrom:
        configMapKeyRef:
          key: DB_DATABASE
          name: RELEASE-NAME-xwiki
should use postgres lts image:
  1: |
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          key: postgresql-password
          name: RELEASE-NAME-postgresql
    - name: INDEX_HOST
      valueFrom:
        configMapKeyRef:
          key: INDEX_HOST
          name: RELEASE-NAME-xwiki
    - name: INDEX_PORT
      valueFrom:
        configMapKeyRef:
          key: INDEX_PORT
          name: RELEASE-NAME-xwiki
    - name: DB_HOST
      valueFrom:
        configMapKeyRef:
          key: DB_HOST
          name: RELEASE-NAME-xwiki
    - name: DB_USER
      valueFrom:
        configMapKeyRef:
          key: DB_USER
          name: RELEASE-NAME-xwiki
    - name: DB_DATABASE
      valueFrom:
        configMapKeyRef:
          key: DB_DATABASE
          name: RELEASE-NAME-xwiki
